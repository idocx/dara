
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Tutorial 2: Phase analysis with tree search &#8212; Dara Documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../_static/autodoc_pydantic.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=87e54e7c" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../_static/documentation_options.js?v=f9c1cefe"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/phase_search';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="icon" href="../_static/logo.svg"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="dara" href="../modules.html" />
    <link rel="prev" title="Tutorial 1: Automated Refinement (with BGMN)" href="automated_refinement.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="1.0.0" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo-wide.svg" class="logo__image only-light" alt="Dara Documentation - Home"/>
    <img src="../_static/logo-wide-dark.svg" class="logo__image only-dark pst-js-only" alt="Dara Documentation - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/idocx/dara" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    Overview
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../web_server.html">Web Server</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../tutorials.html">Tutorials</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="automated_refinement.html">1. Automated refinement with BGMN</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">2. Phase analysis with tree search</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../modules.html">API Docs</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../dara.html">dara package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../dara.bgmn.html">dara.bgmn package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../dara.bgmn.download_bgmn.html">dara.bgmn.download_bgmn module</a></li>
</ul>
</details></li>
<li class="toctree-l3"><a class="reference internal" href="../dara.data.html">dara.data package</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../dara.prediction.html">dara.prediction package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../dara.prediction.base.html">dara.prediction.base module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dara.prediction.core.html">dara.prediction.core module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dara.prediction.rn.html">dara.prediction.rn module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dara.prediction.rxn_ca.html">dara.prediction.rxn_ca module</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../dara.search.html">dara.search package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../dara.search.core.html">dara.search.core module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dara.search.data_model.html">dara.search.data_model module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dara.search.peak_matcher.html">dara.search.peak_matcher module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dara.search.tree.html">dara.search.tree module</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../dara.server.html">dara.server package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../dara.server.api_router.html">dara.server.api_router module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dara.server.app.html">dara.server.app module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dara.server.setting.html">dara.server.setting module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dara.server.utils.html">dara.server.utils module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dara.server.worker.html">dara.server.worker module</a></li>
</ul>
</details></li>
<li class="toctree-l3"><a class="reference internal" href="../dara.bgmn_worker.html">dara.bgmn_worker module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dara.cif.html">dara.cif module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dara.cif2str.html">dara.cif2str module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dara.cli.html">dara.cli module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dara.eflech_worker.html">dara.eflech_worker module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dara.generate_control_file.html">dara.generate_control_file module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dara.jobs.html">dara.jobs module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dara.peak_detection.html">dara.peak_detection module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dara.plot.html">dara.plot module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dara.refine.html">dara.refine module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dara.result.html">dara.result module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dara.schema.html">dara.schema module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dara.settings.html">dara.settings module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dara.structure_db.html">dara.structure_db module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dara.utils.html">dara.utils module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dara.xrd.html">dara.xrd module</a></li>
</ul>
</details></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/idocx/dara" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/idocx/dara/blob/docs/notebooks/phase_search.ipynb?plain=1" target="_blank"
   class="btn btn-sm btn-source-file-button dropdown-item"
   title="Show source"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-code"></i>
  </span>
<span class="btn__text-container">Show source</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/notebooks/phase_search.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Tutorial 2: Phase analysis with tree search</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-1-prepare-reference-phases">Step 1: Prepare reference phases</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-2-search-for-phases">Step 2: Search for phases</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-3-result-analysis">Step 3: Result analysis</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="tutorial-2-phase-analysis-with-tree-search">
<h1>Tutorial 2: Phase analysis with tree search<a class="headerlink" href="#tutorial-2-phase-analysis-with-tree-search" title="Link to this heading">#</a></h1>
<p>Dara is equipped with a parallelized tree search algorithm to identify possible phases
present in a given XRD pattern.</p>
<p>In this tutorial, we will try to identify the phases in one experimental solid-state
reaction sample between <code class="docutils literal notranslate"><span class="pre">GeO2</span></code> and <code class="docutils literal notranslate"><span class="pre">ZnO</span></code>.</p>
<blockquote>
<div><p>You can download this tutorial project from <a class="reference external" href="https://idocx.github.io/dara/_static/tutorial.zip">here</a>.</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">pip</span> install ipywidgets nbformat
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">dara</span><span class="w"> </span><span class="kn">import</span> <span class="n">search_phases</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pattern_path</span> <span class="o">=</span> <span class="s2">&quot;tutorial_data/GeO2-ZnO_700C_60min.xrdml&quot;</span>

<span class="c1"># three elements are present in the sample</span>
<span class="n">chemical_system</span> <span class="o">=</span> <span class="s2">&quot;Ge-O-Zn&quot;</span>
</pre></div>
</div>
</div>
</div>
<section id="step-1-prepare-reference-phases">
<h2>Step 1: Prepare reference phases<a class="headerlink" href="#step-1-prepare-reference-phases" title="Link to this heading">#</a></h2>
<p>Dara pre-builds an index of all the unique and low-energy phases in ICSD and COD
databases. It also implements a method to download CIF structures from COD data server
so that there is no need to obtain the offline database.</p>
<p>Before every search, we will need to gather all the reference phases in the chemical
system for the search algorithm. Dara provides <code class="docutils literal notranslate"><span class="pre">ICSDDatabase</span></code> and <code class="docutils literal notranslate"><span class="pre">CODDatabase</span></code> to do
the filtering.</p>
<p>In this example, we will use <code class="docutils literal notranslate"><span class="pre">CODDatabase</span></code> to download all the phases in the chemical system of <code class="docutils literal notranslate"><span class="pre">Ge-O-Zn</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">dara.structure_db</span><span class="w"> </span><span class="kn">import</span> <span class="n">CODDatabase</span>

<span class="c1"># The COD database contains methods to filter phases in the chemical system</span>
<span class="n">cod_database</span> <span class="o">=</span> <span class="n">CODDatabase</span><span class="p">()</span>

<span class="c1"># gather reference phases and save them to a directory called &quot;cifs&quot;</span>
<span class="n">all_icsd_ids</span> <span class="o">=</span> <span class="n">cod_database</span><span class="o">.</span><span class="n">get_cifs_by_chemsys</span><span class="p">(</span><span class="n">chemical_system</span><span class="p">,</span> <span class="n">dest_dir</span><span class="o">=</span><span class="s2">&quot;cifs&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-10-02 18:54:08,569 WARNING dara.structure_db Local copy of database not found. Attempting to download structures...
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "dd116da63f9f46dcab23ea9fb0424ea5"}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Failed to download 1537396: HTTPSConnectionPool(host=&#39;www.crystallography.net&#39;, port=443): Read timed out. (read timeout=30)
Failed to download 2106196: HTTPSConnectionPool(host=&#39;www.crystallography.net&#39;, port=443): Read timed out. (read timeout=30)
Failed to download 9013109: HTTPSConnectionPool(host=&#39;www.crystallography.net&#39;, port=443): Read timed out. (read timeout=30)
Failed to download 1527883: HTTPSConnectionPool(host=&#39;www.crystallography.net&#39;, port=443): Read timed out. (read timeout=30)
Failed to download 9009215: HTTPSConnectionPool(host=&#39;www.crystallography.net&#39;, port=443): Read timed out. (read timeout=30)
Failed to download 9004178: HTTPSConnectionPool(host=&#39;www.crystallography.net&#39;, port=443): Read timed out. (read timeout=30)
Failed to download 1525835: HTTPSConnectionPool(host=&#39;www.crystallography.net&#39;, port=443): Read timed out. (read timeout=30)
Failed to download 7101738: HTTPSConnectionPool(host=&#39;www.crystallography.net&#39;, port=443): Read timed out. (read timeout=30)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Failed to download 1525833: HTTPSConnectionPool(host=&#39;www.crystallography.net&#39;, port=443): Read timed out. (read timeout=30)
Failed to download 2300365: HTTPSConnectionPool(host=&#39;www.crystallography.net&#39;, port=443): Read timed out. (read timeout=30)
Failed to download 2310614: HTTPSConnectionPool(host=&#39;www.crystallography.net&#39;, port=443): Read timed out. (read timeout=30)
Failed to download 1528620: HTTPSConnectionPool(host=&#39;www.crystallography.net&#39;, port=443): Read timed out. (read timeout=30)
Failed to download 9012435: HTTPSConnectionPool(host=&#39;www.crystallography.net&#39;, port=443): Read timed out. (read timeout=30)
Failed to download 1549041: HTTPSConnectionPool(host=&#39;www.crystallography.net&#39;, port=443): Read timed out. (read timeout=30)
Failed to download 9011647: HTTPSConnectionPool(host=&#39;www.crystallography.net&#39;, port=443): Read timed out. (read timeout=30)
Failed to download 1541503: HTTPSConnectionPool(host=&#39;www.crystallography.net&#39;, port=443): Read timed out. (read timeout=30)
Failed to download 1536063: HTTPSConnectionPool(host=&#39;www.crystallography.net&#39;, port=443): Read timed out. (read timeout=30)
Failed to download 1007256: HTTPSConnectionPool(host=&#39;www.crystallography.net&#39;, port=443): Read timed out. (read timeout=30)
Failed to download 4030923: HTTPSConnectionPool(host=&#39;www.crystallography.net&#39;, port=443): Read timed out. (read timeout=30)
Failed to download 1528336: HTTPSConnectionPool(host=&#39;www.crystallography.net&#39;, port=443): Read timed out. (read timeout=30)
Failed to download 1526227: HTTPSConnectionPool(host=&#39;www.crystallography.net&#39;, port=443): Read timed out. (read timeout=30)
Failed to download 9014631: HTTPSConnectionPool(host=&#39;www.crystallography.net&#39;, port=443): Read timed out. (read timeout=30)
Failed to download 1538108: HTTPSConnectionPool(host=&#39;www.crystallography.net&#39;, port=443): Read timed out. (read timeout=30)
Failed to download 9011050: HTTPSConnectionPool(host=&#39;www.crystallography.net&#39;, port=443): Read timed out. (read timeout=30)
Failed to download 9007435: HTTPSConnectionPool(host=&#39;www.crystallography.net&#39;, port=443): Read timed out. (read timeout=30)
Failed to download 2106877: HTTPSConnectionPool(host=&#39;www.crystallography.net&#39;, port=443): Read timed out. (read timeout=30)
Failed to download 1533322: HTTPSConnectionPool(host=&#39;www.crystallography.net&#39;, port=443): Read timed out. (read timeout=30)
Failed to download 9007477: HTTPSConnectionPool(host=&#39;www.crystallography.net&#39;, port=443): Read timed out. (read timeout=30)
Failed to download 2104024: HTTPSConnectionPool(host=&#39;www.crystallography.net&#39;, port=443): Read timed out. (read timeout=30)
Failed to download 4517837: HTTPSConnectionPool(host=&#39;www.crystallography.net&#39;, port=443): Read timed out. (read timeout=30)
Failed to download 1537875: HTTPSConnectionPool(host=&#39;www.crystallography.net&#39;, port=443): Read timed out. (read timeout=30)
Failed to download 8000212: HTTPSConnectionPool(host=&#39;www.crystallography.net&#39;, port=443): Read timed out. (read timeout=30)
Failed to download 1541798: HTTPSConnectionPool(host=&#39;www.crystallography.net&#39;, port=443): Read timed out. (read timeout=30)
Failed to download 2106431: HTTPSConnectionPool(host=&#39;www.crystallography.net&#39;, port=443): Read timed out. (read timeout=30)
Failed to download 9006858: HTTPSConnectionPool(host=&#39;www.crystallography.net&#39;, port=443): Read timed out. (read timeout=30)
Failed to download 1529590: HTTPSConnectionPool(host=&#39;www.crystallography.net&#39;, port=443): Read timed out. (read timeout=30)
Failed to download 1528389: HTTPSConnectionPool(host=&#39;www.crystallography.net&#39;, port=443): Read timed out. (read timeout=30)
Failed to download 9017498: HTTPSConnectionPool(host=&#39;www.crystallography.net&#39;, port=443): Read timed out. (read timeout=30)
Failed to download 1011223: HTTPSConnectionPool(host=&#39;www.crystallography.net&#39;, port=443): Read timed out. (read timeout=30)
Failed to download 9015579: HTTPSConnectionPool(host=&#39;www.crystallography.net&#39;, port=443): Read timed out. (read timeout=30)
Failed to download 1549040: HTTPSConnectionPool(host=&#39;www.crystallography.net&#39;, port=443): Read timed out. (read timeout=30)
</pre></div>
</div>
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">TimeoutError</span><span class="g g-Whitespace">                              </span>Traceback (most recent call last)
<span class="nn">File ~/work/dara/dara/.venv/lib/python3.12/site-packages/urllib3/connectionpool.py:464,</span> in <span class="ni">HTTPConnectionPool._make_request</span><span class="nt">(self, conn, method, url, body, headers, retries, timeout, chunked, response_conn, preload_content, decode_content, enforce_content_length)</span>
<span class="g g-Whitespace">    </span><span class="mi">463</span> <span class="k">try</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">464</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_validate_conn</span><span class="p">(</span><span class="n">conn</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">465</span> <span class="k">except</span> <span class="p">(</span><span class="n">SocketTimeout</span><span class="p">,</span> <span class="n">BaseSSLError</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>

<span class="nn">File ~/work/dara/dara/.venv/lib/python3.12/site-packages/urllib3/connectionpool.py:1093,</span> in <span class="ni">HTTPSConnectionPool._validate_conn</span><span class="nt">(self, conn)</span>
<span class="g g-Whitespace">   </span><span class="mi">1092</span> <span class="k">if</span> <span class="n">conn</span><span class="o">.</span><span class="n">is_closed</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">1093</span>     <span class="n">conn</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
<span class="g g-Whitespace">   </span><span class="mi">1095</span> <span class="c1"># TODO revise this, see https://github.com/urllib3/urllib3/issues/2791</span>

<span class="nn">File ~/work/dara/dara/.venv/lib/python3.12/site-packages/urllib3/connection.py:790,</span> in <span class="ni">HTTPSConnection.connect</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">788</span> <span class="n">server_hostname_rm_dot</span> <span class="o">=</span> <span class="n">server_hostname</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">790</span> <span class="n">sock_and_verified</span> <span class="o">=</span> <span class="n">_ssl_wrap_socket_and_match_hostname</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">791</span>     <span class="n">sock</span><span class="o">=</span><span class="n">sock</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">792</span>     <span class="n">cert_reqs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cert_reqs</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">793</span>     <span class="n">ssl_version</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ssl_version</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">794</span>     <span class="n">ssl_minimum_version</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ssl_minimum_version</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">795</span>     <span class="n">ssl_maximum_version</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ssl_maximum_version</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">796</span>     <span class="n">ca_certs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ca_certs</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">797</span>     <span class="n">ca_cert_dir</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ca_cert_dir</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">798</span>     <span class="n">ca_cert_data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ca_cert_data</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">799</span>     <span class="n">cert_file</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cert_file</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">800</span>     <span class="n">key_file</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">key_file</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">801</span>     <span class="n">key_password</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">key_password</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">802</span>     <span class="n">server_hostname</span><span class="o">=</span><span class="n">server_hostname_rm_dot</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">803</span>     <span class="n">ssl_context</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ssl_context</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">804</span>     <span class="n">tls_in_tls</span><span class="o">=</span><span class="n">tls_in_tls</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">805</span>     <span class="n">assert_hostname</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">assert_hostname</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">806</span>     <span class="n">assert_fingerprint</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">assert_fingerprint</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">807</span> <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">808</span> <span class="bp">self</span><span class="o">.</span><span class="n">sock</span> <span class="o">=</span> <span class="n">sock_and_verified</span><span class="o">.</span><span class="n">socket</span>

<span class="nn">File ~/work/dara/dara/.venv/lib/python3.12/site-packages/urllib3/connection.py:969,</span> in <span class="ni">_ssl_wrap_socket_and_match_hostname</span><span class="nt">(sock, cert_reqs, ssl_version, ssl_minimum_version, ssl_maximum_version, cert_file, key_file, key_password, ca_certs, ca_cert_dir, ca_cert_data, assert_hostname, assert_fingerprint, server_hostname, ssl_context, tls_in_tls)</span>
<span class="g g-Whitespace">    </span><span class="mi">967</span>         <span class="n">server_hostname</span> <span class="o">=</span> <span class="n">normalized</span>
<span class="ne">--&gt; </span><span class="mi">969</span> <span class="n">ssl_sock</span> <span class="o">=</span> <span class="n">ssl_wrap_socket</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">970</span>     <span class="n">sock</span><span class="o">=</span><span class="n">sock</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">971</span>     <span class="n">keyfile</span><span class="o">=</span><span class="n">key_file</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">972</span>     <span class="n">certfile</span><span class="o">=</span><span class="n">cert_file</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">973</span>     <span class="n">key_password</span><span class="o">=</span><span class="n">key_password</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">974</span>     <span class="n">ca_certs</span><span class="o">=</span><span class="n">ca_certs</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">975</span>     <span class="n">ca_cert_dir</span><span class="o">=</span><span class="n">ca_cert_dir</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">976</span>     <span class="n">ca_cert_data</span><span class="o">=</span><span class="n">ca_cert_data</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">977</span>     <span class="n">server_hostname</span><span class="o">=</span><span class="n">server_hostname</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">978</span>     <span class="n">ssl_context</span><span class="o">=</span><span class="n">context</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">979</span>     <span class="n">tls_in_tls</span><span class="o">=</span><span class="n">tls_in_tls</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">980</span> <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">982</span> <span class="k">try</span><span class="p">:</span>

<span class="nn">File ~/work/dara/dara/.venv/lib/python3.12/site-packages/urllib3/util/ssl_.py:480,</span> in <span class="ni">ssl_wrap_socket</span><span class="nt">(sock, keyfile, certfile, cert_reqs, ca_certs, server_hostname, ssl_version, ciphers, ssl_context, ca_cert_dir, key_password, ca_cert_data, tls_in_tls)</span>
<span class="g g-Whitespace">    </span><span class="mi">478</span> <span class="n">context</span><span class="o">.</span><span class="n">set_alpn_protocols</span><span class="p">(</span><span class="n">ALPN_PROTOCOLS</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">480</span> <span class="n">ssl_sock</span> <span class="o">=</span> <span class="n">_ssl_wrap_socket_impl</span><span class="p">(</span><span class="n">sock</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="n">tls_in_tls</span><span class="p">,</span> <span class="n">server_hostname</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">481</span> <span class="k">return</span> <span class="n">ssl_sock</span>

<span class="nn">File ~/work/dara/dara/.venv/lib/python3.12/site-packages/urllib3/util/ssl_.py:524,</span> in <span class="ni">_ssl_wrap_socket_impl</span><span class="nt">(sock, ssl_context, tls_in_tls, server_hostname)</span>
<span class="g g-Whitespace">    </span><span class="mi">522</span>     <span class="k">return</span> <span class="n">SSLTransport</span><span class="p">(</span><span class="n">sock</span><span class="p">,</span> <span class="n">ssl_context</span><span class="p">,</span> <span class="n">server_hostname</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">524</span> <span class="k">return</span> <span class="n">ssl_context</span><span class="o">.</span><span class="n">wrap_socket</span><span class="p">(</span><span class="n">sock</span><span class="p">,</span> <span class="n">server_hostname</span><span class="o">=</span><span class="n">server_hostname</span><span class="p">)</span>

<span class="nn">File /usr/lib/python3.12/ssl.py:455,</span> in <span class="ni">SSLContext.wrap_socket</span><span class="nt">(self, sock, server_side, do_handshake_on_connect, suppress_ragged_eofs, server_hostname, session)</span>
<span class="g g-Whitespace">    </span><span class="mi">449</span> <span class="k">def</span><span class="w"> </span><span class="nf">wrap_socket</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sock</span><span class="p">,</span> <span class="n">server_side</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">450</span>                 <span class="n">do_handshake_on_connect</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">451</span>                 <span class="n">suppress_ragged_eofs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">452</span>                 <span class="n">server_hostname</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">session</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">453</span>     <span class="c1"># SSLSocket class handles server_hostname encoding before it calls</span>
<span class="g g-Whitespace">    </span><span class="mi">454</span>     <span class="c1"># ctx._wrap_socket()</span>
<span class="ne">--&gt; </span><span class="mi">455</span>     <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sslsocket_class</span><span class="o">.</span><span class="n">_create</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">456</span>         <span class="n">sock</span><span class="o">=</span><span class="n">sock</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">457</span>         <span class="n">server_side</span><span class="o">=</span><span class="n">server_side</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">458</span>         <span class="n">do_handshake_on_connect</span><span class="o">=</span><span class="n">do_handshake_on_connect</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">459</span>         <span class="n">suppress_ragged_eofs</span><span class="o">=</span><span class="n">suppress_ragged_eofs</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">460</span>         <span class="n">server_hostname</span><span class="o">=</span><span class="n">server_hostname</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">461</span>         <span class="n">context</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">462</span>         <span class="n">session</span><span class="o">=</span><span class="n">session</span>
<span class="g g-Whitespace">    </span><span class="mi">463</span>     <span class="p">)</span>

<span class="nn">File /usr/lib/python3.12/ssl.py:1042,</span> in <span class="ni">SSLSocket._create</span><span class="nt">(cls, sock, server_side, do_handshake_on_connect, suppress_ragged_eofs, server_hostname, context, session)</span>
<span class="g g-Whitespace">   </span><span class="mi">1041</span>                 <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;do_handshake_on_connect should not be specified for non-blocking sockets&quot;</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">1042</span>             <span class="bp">self</span><span class="o">.</span><span class="n">do_handshake</span><span class="p">()</span>
<span class="g g-Whitespace">   </span><span class="mi">1043</span> <span class="k">except</span><span class="p">:</span>

<span class="nn">File /usr/lib/python3.12/ssl.py:1320,</span> in <span class="ni">SSLSocket.do_handshake</span><span class="nt">(self, block)</span>
<span class="g g-Whitespace">   </span><span class="mi">1319</span>         <span class="bp">self</span><span class="o">.</span><span class="n">settimeout</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">1320</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_sslobj</span><span class="o">.</span><span class="n">do_handshake</span><span class="p">()</span>
<span class="g g-Whitespace">   </span><span class="mi">1321</span> <span class="k">finally</span><span class="p">:</span>

<span class="ne">TimeoutError</span>: _ssl.c:983: The handshake operation timed out

<span class="n">The</span> <span class="n">above</span> <span class="n">exception</span> <span class="n">was</span> <span class="n">the</span> <span class="n">direct</span> <span class="n">cause</span> <span class="n">of</span> <span class="n">the</span> <span class="n">following</span> <span class="n">exception</span><span class="p">:</span>

<span class="ne">ReadTimeoutError</span><span class="g g-Whitespace">                          </span>Traceback (most recent call last)
<span class="nn">File ~/work/dara/dara/.venv/lib/python3.12/site-packages/requests/adapters.py:644,</span> in <span class="ni">HTTPAdapter.send</span><span class="nt">(self, request, stream, timeout, verify, cert, proxies)</span>
<span class="g g-Whitespace">    </span><span class="mi">643</span> <span class="k">try</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">644</span>     <span class="n">resp</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">645</span>         <span class="n">method</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">method</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">646</span>         <span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">647</span>         <span class="n">body</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">body</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">648</span>         <span class="n">headers</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">headers</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">649</span>         <span class="n">redirect</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">650</span>         <span class="n">assert_same_host</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">651</span>         <span class="n">preload_content</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">652</span>         <span class="n">decode_content</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">653</span>         <span class="n">retries</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">max_retries</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">654</span>         <span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">655</span>         <span class="n">chunked</span><span class="o">=</span><span class="n">chunked</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">656</span>     <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">658</span> <span class="k">except</span> <span class="p">(</span><span class="n">ProtocolError</span><span class="p">,</span> <span class="ne">OSError</span><span class="p">)</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>

<span class="nn">File ~/work/dara/dara/.venv/lib/python3.12/site-packages/urllib3/connectionpool.py:841,</span> in <span class="ni">HTTPConnectionPool.urlopen</span><span class="nt">(self, method, url, body, headers, retries, redirect, assert_same_host, timeout, pool_timeout, release_conn, chunked, body_pos, preload_content, decode_content, **response_kw)</span>
<span class="g g-Whitespace">    </span><span class="mi">839</span>     <span class="n">new_e</span> <span class="o">=</span> <span class="n">ProtocolError</span><span class="p">(</span><span class="s2">&quot;Connection aborted.&quot;</span><span class="p">,</span> <span class="n">new_e</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">841</span> <span class="n">retries</span> <span class="o">=</span> <span class="n">retries</span><span class="o">.</span><span class="n">increment</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">842</span>     <span class="n">method</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="n">new_e</span><span class="p">,</span> <span class="n">_pool</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">_stacktrace</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">exc_info</span><span class="p">()[</span><span class="mi">2</span><span class="p">]</span>
<span class="g g-Whitespace">    </span><span class="mi">843</span> <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">844</span> <span class="n">retries</span><span class="o">.</span><span class="n">sleep</span><span class="p">()</span>

<span class="nn">File ~/work/dara/dara/.venv/lib/python3.12/site-packages/urllib3/util/retry.py:474,</span> in <span class="ni">Retry.increment</span><span class="nt">(self, method, url, response, error, _pool, _stacktrace)</span>
<span class="g g-Whitespace">    </span><span class="mi">473</span> <span class="k">if</span> <span class="n">read</span> <span class="ow">is</span> <span class="kc">False</span> <span class="ow">or</span> <span class="n">method</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_method_retryable</span><span class="p">(</span><span class="n">method</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">474</span>     <span class="k">raise</span> <span class="n">reraise</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">error</span><span class="p">),</span> <span class="n">error</span><span class="p">,</span> <span class="n">_stacktrace</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">475</span> <span class="k">elif</span> <span class="n">read</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

<span class="nn">File ~/work/dara/dara/.venv/lib/python3.12/site-packages/urllib3/util/util.py:39,</span> in <span class="ni">reraise</span><span class="nt">(tp, value, tb)</span>
<span class="g g-Whitespace">     </span><span class="mi">38</span>         <span class="k">raise</span> <span class="n">value</span><span class="o">.</span><span class="n">with_traceback</span><span class="p">(</span><span class="n">tb</span><span class="p">)</span>
<span class="ne">---&gt; </span><span class="mi">39</span>     <span class="k">raise</span> <span class="n">value</span>
<span class="g g-Whitespace">     </span><span class="mi">40</span> <span class="k">finally</span><span class="p">:</span>

<span class="nn">File ~/work/dara/dara/.venv/lib/python3.12/site-packages/urllib3/connectionpool.py:787,</span> in <span class="ni">HTTPConnectionPool.urlopen</span><span class="nt">(self, method, url, body, headers, retries, redirect, assert_same_host, timeout, pool_timeout, release_conn, chunked, body_pos, preload_content, decode_content, **response_kw)</span>
<span class="g g-Whitespace">    </span><span class="mi">786</span> <span class="c1"># Make the request on the HTTPConnection object</span>
<span class="ne">--&gt; </span><span class="mi">787</span> <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_request</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">788</span>     <span class="n">conn</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">789</span>     <span class="n">method</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">790</span>     <span class="n">url</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">791</span>     <span class="n">timeout</span><span class="o">=</span><span class="n">timeout_obj</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">792</span>     <span class="n">body</span><span class="o">=</span><span class="n">body</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">793</span>     <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">794</span>     <span class="n">chunked</span><span class="o">=</span><span class="n">chunked</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">795</span>     <span class="n">retries</span><span class="o">=</span><span class="n">retries</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">796</span>     <span class="n">response_conn</span><span class="o">=</span><span class="n">response_conn</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">797</span>     <span class="n">preload_content</span><span class="o">=</span><span class="n">preload_content</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">798</span>     <span class="n">decode_content</span><span class="o">=</span><span class="n">decode_content</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">799</span>     <span class="o">**</span><span class="n">response_kw</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">800</span> <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">802</span> <span class="c1"># Everything went great!</span>

<span class="nn">File ~/work/dara/dara/.venv/lib/python3.12/site-packages/urllib3/connectionpool.py:488,</span> in <span class="ni">HTTPConnectionPool._make_request</span><span class="nt">(self, conn, method, url, body, headers, retries, timeout, chunked, response_conn, preload_content, decode_content, enforce_content_length)</span>
<span class="g g-Whitespace">    </span><span class="mi">487</span>         <span class="n">new_e</span> <span class="o">=</span> <span class="n">_wrap_proxy_error</span><span class="p">(</span><span class="n">new_e</span><span class="p">,</span> <span class="n">conn</span><span class="o">.</span><span class="n">proxy</span><span class="o">.</span><span class="n">scheme</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">488</span>     <span class="k">raise</span> <span class="n">new_e</span>
<span class="g g-Whitespace">    </span><span class="mi">490</span> <span class="c1"># conn.request() calls http.client.*.request, not the method in</span>
<span class="g g-Whitespace">    </span><span class="mi">491</span> <span class="c1"># urllib3.request. It also calls makefile (recv) on the socket.</span>

<span class="nn">File ~/work/dara/dara/.venv/lib/python3.12/site-packages/urllib3/connectionpool.py:466,</span> in <span class="ni">HTTPConnectionPool._make_request</span><span class="nt">(self, conn, method, url, body, headers, retries, timeout, chunked, response_conn, preload_content, decode_content, enforce_content_length)</span>
<span class="g g-Whitespace">    </span><span class="mi">465</span> <span class="k">except</span> <span class="p">(</span><span class="n">SocketTimeout</span><span class="p">,</span> <span class="n">BaseSSLError</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">466</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_raise_timeout</span><span class="p">(</span><span class="n">err</span><span class="o">=</span><span class="n">e</span><span class="p">,</span> <span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span> <span class="n">timeout_value</span><span class="o">=</span><span class="n">conn</span><span class="o">.</span><span class="n">timeout</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">467</span>     <span class="k">raise</span>

<span class="nn">File ~/work/dara/dara/.venv/lib/python3.12/site-packages/urllib3/connectionpool.py:367,</span> in <span class="ni">HTTPConnectionPool._raise_timeout</span><span class="nt">(self, err, url, timeout_value)</span>
<span class="g g-Whitespace">    </span><span class="mi">366</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">err</span><span class="p">,</span> <span class="n">SocketTimeout</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">367</span>     <span class="k">raise</span> <span class="n">ReadTimeoutError</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">368</span>         <span class="bp">self</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Read timed out. (read timeout=</span><span class="si">{</span><span class="n">timeout_value</span><span class="si">}</span><span class="s2">)&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">369</span>     <span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">err</span>
<span class="g g-Whitespace">    </span><span class="mi">371</span> <span class="c1"># See the above comment about EAGAIN in Python 3.</span>

<span class="ne">ReadTimeoutError</span>: HTTPSConnectionPool(host=&#39;www.crystallography.net&#39;, port=443): Read timed out. (read timeout=30)

<span class="n">During</span> <span class="n">handling</span> <span class="n">of</span> <span class="n">the</span> <span class="n">above</span> <span class="n">exception</span><span class="p">,</span> <span class="n">another</span> <span class="n">exception</span> <span class="n">occurred</span><span class="p">:</span>

<span class="ne">ReadTimeout</span><span class="g g-Whitespace">                               </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">line</span> <span class="mi">7</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="n">cod_database</span> <span class="o">=</span> <span class="n">CODDatabase</span><span class="p">()</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span> <span class="c1"># gather reference phases and save them to a directory called &quot;cifs&quot;</span>
<span class="ne">----&gt; </span><span class="mi">7</span> <span class="n">all_icsd_ids</span> <span class="o">=</span> <span class="n">cod_database</span><span class="o">.</span><span class="n">get_cifs_by_chemsys</span><span class="p">(</span><span class="n">chemical_system</span><span class="p">,</span> <span class="n">dest_dir</span><span class="o">=</span><span class="s2">&quot;cifs&quot;</span><span class="p">)</span>

<span class="nn">File ~/work/dara/dara/src/dara/structure_db.py:107,</span> in <span class="ni">StructureDatabase.get_cifs_by_chemsys</span><span class="nt">(self, chemsys, e_hull_filter, copy_files, dest_dir, exclude_gases)</span>
<span class="g g-Whitespace">    </span><span class="mi">104</span>         <span class="k">if</span> <span class="n">sub_chemsys</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">preparsed_info</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">105</span>             <span class="n">all_data</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">preparsed_info</span><span class="p">[</span><span class="n">sub_chemsys</span><span class="p">])</span>
<span class="ne">--&gt; </span><span class="mi">107</span> <span class="n">file_map</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generate_file_map</span><span class="p">(</span><span class="n">all_data</span><span class="p">,</span> <span class="n">e_hull_filter</span><span class="p">,</span> <span class="n">exclude_gases</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">109</span> <span class="k">if</span> <span class="n">copy_files</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">110</span>     <span class="n">copy_and_rename_files</span><span class="p">(</span><span class="n">file_map</span><span class="p">,</span> <span class="n">dest_dir</span><span class="p">)</span>

<span class="nn">File ~/work/dara/dara/src/dara/structure_db.py:148,</span> in <span class="ni">StructureDatabase._generate_file_map</span><span class="nt">(self, all_data, e_hull_filter, exclude_gases, download_folder)</span>
<span class="g g-Whitespace">    </span><span class="mi">144</span> <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">local_copy_found</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">145</span>     <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">146</span>         <span class="s2">&quot;Local copy of database not found. Attempting to download structures...&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">147</span>     <span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">148</span>     <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">download_structures</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">149</span>         <span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">all_data</span><span class="p">],</span>
<span class="g g-Whitespace">    </span><span class="mi">150</span>         <span class="n">save</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">151</span>         <span class="n">default_folder</span><span class="o">=</span><span class="n">download_folder</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">152</span>     <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">154</span> <span class="n">file_map</span> <span class="o">=</span> <span class="p">{}</span>
<span class="g g-Whitespace">    </span><span class="mi">155</span> <span class="k">for</span> <span class="n">formula</span><span class="p">,</span> <span class="n">code</span><span class="p">,</span> <span class="n">sg</span><span class="p">,</span> <span class="n">e_hull</span> <span class="ow">in</span> <span class="n">all_data</span><span class="p">:</span>

<span class="nn">File ~/work/dara/dara/src/dara/structure_db.py:259,</span> in <span class="ni">CODDatabase.download_structures</span><span class="nt">(self, ids, save, default_folder)</span>
<span class="g g-Whitespace">    </span><span class="mi">247</span> <span class="k">def</span><span class="w"> </span><span class="nf">download_structures</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">248</span>     <span class="bp">self</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">249</span>     <span class="n">ids</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">250</span>     <span class="n">save</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">251</span>     <span class="n">default_folder</span><span class="o">=</span><span class="s2">&quot;downloaded_cod_cifs&quot;</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">252</span> <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Cif</span><span class="p">]:</span>
<span class="g g-Whitespace">    </span><span class="mi">253</span><span class="w">     </span><span class="sd">&quot;&quot;&quot;Download structures from the COD database. Note that this downloads directly</span>
<span class="g g-Whitespace">    </span><span class="mi">254</span><span class="sd">     from the COD website, so it may be slow. Please do not abuse this feature.</span>
<span class="g g-Whitespace">    </span><span class="mi">255</span><span class="sd"> </span>
<span class="g g-Whitespace">    </span><span class="mi">256</span><span class="sd">     Args:</span>
<span class="g g-Whitespace">    </span><span class="mi">257</span><span class="sd">         ids: List of COD IDs to download.</span>
<span class="g g-Whitespace">    </span><span class="mi">258</span><span class="sd">     &quot;&quot;&quot;</span>
<span class="ne">--&gt; </span><span class="mi">259</span>     <span class="n">cifs</span> <span class="o">=</span> <span class="n">thread_map</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">260</span>         <span class="bp">self</span><span class="o">.</span><span class="n">_download_cod</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">261</span>         <span class="n">ids</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">262</span>         <span class="n">chunksize</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">263</span>         <span class="n">max_workers</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">264</span>         <span class="n">desc</span><span class="o">=</span><span class="s2">&quot;Downloading CIFs from COD...&quot;</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">265</span>     <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">266</span>     <span class="k">if</span> <span class="n">save</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">267</span>         <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Saving downloaded CIFs to </span><span class="si">{</span><span class="n">default_folder</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="nn">File ~/work/dara/dara/.venv/lib/python3.12/site-packages/tqdm/contrib/concurrent.py:69,</span> in <span class="ni">thread_map</span><span class="nt">(fn, *iterables, **tqdm_kwargs)</span>
<span class="g g-Whitespace">     </span><span class="mi">55</span><span class="w"> </span><span class="sd">&quot;&quot;&quot;</span>
<span class="g g-Whitespace">     </span><span class="mi">56</span><span class="sd"> Equivalent of `list(map(fn, *iterables))`</span>
<span class="g g-Whitespace">     </span><span class="mi">57</span><span class="sd"> driven by `concurrent.futures.ThreadPoolExecutor`.</span>
<span class="sd">   (...)     66     [default: max(32, cpu_count() + 4)].</span>
<span class="g g-Whitespace">     </span><span class="mi">67</span><span class="sd"> &quot;&quot;&quot;</span>
<span class="g g-Whitespace">     </span><span class="mi">68</span> <span class="kn">from</span><span class="w"> </span><span class="nn">concurrent.futures</span><span class="w"> </span><span class="kn">import</span> <span class="n">ThreadPoolExecutor</span>
<span class="ne">---&gt; </span><span class="mi">69</span> <span class="k">return</span> <span class="n">_executor_map</span><span class="p">(</span><span class="n">ThreadPoolExecutor</span><span class="p">,</span> <span class="n">fn</span><span class="p">,</span> <span class="o">*</span><span class="n">iterables</span><span class="p">,</span> <span class="o">**</span><span class="n">tqdm_kwargs</span><span class="p">)</span>

<span class="nn">File ~/work/dara/dara/.venv/lib/python3.12/site-packages/tqdm/contrib/concurrent.py:51,</span> in <span class="ni">_executor_map</span><span class="nt">(PoolExecutor, fn, *iterables, **tqdm_kwargs)</span>
<span class="g g-Whitespace">     </span><span class="mi">47</span> <span class="k">with</span> <span class="n">ensure_lock</span><span class="p">(</span><span class="n">tqdm_class</span><span class="p">,</span> <span class="n">lock_name</span><span class="o">=</span><span class="n">lock_name</span><span class="p">)</span> <span class="k">as</span> <span class="n">lk</span><span class="p">:</span>
<span class="g g-Whitespace">     </span><span class="mi">48</span>     <span class="c1"># share lock in case workers are already using `tqdm`</span>
<span class="g g-Whitespace">     </span><span class="mi">49</span>     <span class="k">with</span> <span class="n">PoolExecutor</span><span class="p">(</span><span class="n">max_workers</span><span class="o">=</span><span class="n">max_workers</span><span class="p">,</span> <span class="n">initializer</span><span class="o">=</span><span class="n">tqdm_class</span><span class="o">.</span><span class="n">set_lock</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">50</span>                       <span class="n">initargs</span><span class="o">=</span><span class="p">(</span><span class="n">lk</span><span class="p">,))</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
<span class="ne">---&gt; </span><span class="mi">51</span>         <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">tqdm_class</span><span class="p">(</span><span class="n">ex</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="o">*</span><span class="n">iterables</span><span class="p">,</span> <span class="n">chunksize</span><span class="o">=</span><span class="n">chunksize</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>

<span class="nn">File ~/work/dara/dara/.venv/lib/python3.12/site-packages/tqdm/notebook.py:250,</span> in <span class="ni">tqdm_notebook.__iter__</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">248</span> <span class="k">try</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">249</span>     <span class="n">it</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__iter__</span><span class="p">()</span>
<span class="ne">--&gt; </span><span class="mi">250</span>     <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">it</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">251</span>         <span class="c1"># return super(tqdm...) will not catch exception</span>
<span class="g g-Whitespace">    </span><span class="mi">252</span>         <span class="k">yield</span> <span class="n">obj</span>
<span class="g g-Whitespace">    </span><span class="mi">253</span> <span class="c1"># NB: except ... [ as ...] breaks IPython async KeyboardInterrupt</span>

<span class="nn">File ~/work/dara/dara/.venv/lib/python3.12/site-packages/tqdm/std.py:1181,</span> in <span class="ni">tqdm.__iter__</span><span class="nt">(self)</span>
<span class="g g-Whitespace">   </span><span class="mi">1178</span> <span class="n">time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_time</span>
<span class="g g-Whitespace">   </span><span class="mi">1180</span> <span class="k">try</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">1181</span>     <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">iterable</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1182</span>         <span class="k">yield</span> <span class="n">obj</span>
<span class="g g-Whitespace">   </span><span class="mi">1183</span>         <span class="c1"># Update and possibly print the progressbar.</span>
<span class="g g-Whitespace">   </span><span class="mi">1184</span>         <span class="c1"># Note: does not call self.update(1) for speed optimisation.</span>

<span class="nn">File /usr/lib/python3.12/concurrent/futures/_base.py:619,</span> in <span class="ni">Executor.map.&lt;locals&gt;.result_iterator</span><span class="nt">()</span>
<span class="g g-Whitespace">    </span><span class="mi">616</span> <span class="k">while</span> <span class="n">fs</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">617</span>     <span class="c1"># Careful not to keep a reference to the popped future</span>
<span class="g g-Whitespace">    </span><span class="mi">618</span>     <span class="k">if</span> <span class="n">timeout</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">619</span>         <span class="k">yield</span> <span class="n">_result_or_cancel</span><span class="p">(</span><span class="n">fs</span><span class="o">.</span><span class="n">pop</span><span class="p">())</span>
<span class="g g-Whitespace">    </span><span class="mi">620</span>     <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">621</span>         <span class="k">yield</span> <span class="n">_result_or_cancel</span><span class="p">(</span><span class="n">fs</span><span class="o">.</span><span class="n">pop</span><span class="p">(),</span> <span class="n">end_time</span> <span class="o">-</span> <span class="n">time</span><span class="o">.</span><span class="n">monotonic</span><span class="p">())</span>

<span class="nn">File /usr/lib/python3.12/concurrent/futures/_base.py:317,</span> in <span class="ni">_result_or_cancel</span><span class="nt">(***failed resolving arguments***)</span>
<span class="g g-Whitespace">    </span><span class="mi">315</span> <span class="k">try</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">316</span>     <span class="k">try</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">317</span>         <span class="k">return</span> <span class="n">fut</span><span class="o">.</span><span class="n">result</span><span class="p">(</span><span class="n">timeout</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">318</span>     <span class="k">finally</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">319</span>         <span class="n">fut</span><span class="o">.</span><span class="n">cancel</span><span class="p">()</span>

<span class="nn">File /usr/lib/python3.12/concurrent/futures/_base.py:456,</span> in <span class="ni">Future.result</span><span class="nt">(self, timeout)</span>
<span class="g g-Whitespace">    </span><span class="mi">454</span>     <span class="k">raise</span> <span class="n">CancelledError</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">455</span> <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_state</span> <span class="o">==</span> <span class="n">FINISHED</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">456</span>     <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_result</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">457</span> <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">458</span>     <span class="k">raise</span> <span class="ne">TimeoutError</span><span class="p">()</span>

<span class="nn">File /usr/lib/python3.12/concurrent/futures/_base.py:401,</span> in <span class="ni">Future.__get_result</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">399</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exception</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">400</span>     <span class="k">try</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">401</span>         <span class="k">raise</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exception</span>
<span class="g g-Whitespace">    </span><span class="mi">402</span>     <span class="k">finally</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">403</span>         <span class="c1"># Break a reference cycle with the exception in self._exception</span>
<span class="g g-Whitespace">    </span><span class="mi">404</span>         <span class="bp">self</span> <span class="o">=</span> <span class="kc">None</span>

<span class="nn">File /usr/lib/python3.12/concurrent/futures/thread.py:58,</span> in <span class="ni">_WorkItem.run</span><span class="nt">(self)</span>
<span class="g g-Whitespace">     </span><span class="mi">55</span>     <span class="k">return</span>
<span class="g g-Whitespace">     </span><span class="mi">57</span> <span class="k">try</span><span class="p">:</span>
<span class="ne">---&gt; </span><span class="mi">58</span>     <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fn</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">59</span> <span class="k">except</span> <span class="ne">BaseException</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
<span class="g g-Whitespace">     </span><span class="mi">60</span>     <span class="bp">self</span><span class="o">.</span><span class="n">future</span><span class="o">.</span><span class="n">set_exception</span><span class="p">(</span><span class="n">exc</span><span class="p">)</span>

<span class="nn">File ~/work/dara/dara/src/dara/structure_db.py:302,</span> in <span class="ni">CODDatabase._download_cod</span><span class="nt">(cod_id)</span>
<span class="g g-Whitespace">    </span><span class="mi">300</span> <span class="k">try</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">301</span>     <span class="n">url</span> <span class="o">=</span> <span class="n">COD_URL</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cod_id</span><span class="o">=</span><span class="n">cod_id</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">302</span>     <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">303</span>     <span class="n">response</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>  <span class="c1"># Raise an error for bad status codes</span>
<span class="g g-Whitespace">    </span><span class="mi">304</span>     <span class="k">with</span> <span class="n">NamedTemporaryFile</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s2">&quot;w+b&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">temp_file</span><span class="p">:</span>

<span class="nn">File ~/work/dara/dara/.venv/lib/python3.12/site-packages/requests/api.py:73,</span> in <span class="ni">get</span><span class="nt">(url, params, **kwargs)</span>
<span class="g g-Whitespace">     </span><span class="mi">62</span> <span class="k">def</span><span class="w"> </span><span class="nf">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="g g-Whitespace">     </span><span class="mi">63</span><span class="w">     </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Sends a GET request.</span>
<span class="g g-Whitespace">     </span><span class="mi">64</span><span class="sd"> </span>
<span class="g g-Whitespace">     </span><span class="mi">65</span><span class="sd">     :param url: URL for the new :class:`Request` object.</span>
<span class="sd">   (...)     70     :rtype: requests.Response</span>
<span class="g g-Whitespace">     </span><span class="mi">71</span><span class="sd">     &quot;&quot;&quot;</span>
<span class="ne">---&gt; </span><span class="mi">73</span>     <span class="k">return</span> <span class="n">request</span><span class="p">(</span><span class="s2">&quot;get&quot;</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="nn">File ~/work/dara/dara/.venv/lib/python3.12/site-packages/requests/api.py:59,</span> in <span class="ni">request</span><span class="nt">(method, url, **kwargs)</span>
<span class="g g-Whitespace">     </span><span class="mi">55</span> <span class="c1"># By using the &#39;with&#39; statement we are sure the session is closed, thus we</span>
<span class="g g-Whitespace">     </span><span class="mi">56</span> <span class="c1"># avoid leaving sockets open which can trigger a ResourceWarning in some</span>
<span class="g g-Whitespace">     </span><span class="mi">57</span> <span class="c1"># cases, and look like a memory leak in others.</span>
<span class="g g-Whitespace">     </span><span class="mi">58</span> <span class="k">with</span> <span class="n">sessions</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
<span class="ne">---&gt; </span><span class="mi">59</span>     <span class="k">return</span> <span class="n">session</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span> <span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="nn">File ~/work/dara/dara/.venv/lib/python3.12/site-packages/requests/sessions.py:589,</span> in <span class="ni">Session.request</span><span class="nt">(self, method, url, params, data, headers, cookies, files, auth, timeout, allow_redirects, proxies, hooks, stream, verify, cert, json)</span>
<span class="g g-Whitespace">    </span><span class="mi">584</span> <span class="n">send_kwargs</span> <span class="o">=</span> <span class="p">{</span>
<span class="g g-Whitespace">    </span><span class="mi">585</span>     <span class="s2">&quot;timeout&quot;</span><span class="p">:</span> <span class="n">timeout</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">586</span>     <span class="s2">&quot;allow_redirects&quot;</span><span class="p">:</span> <span class="n">allow_redirects</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">587</span> <span class="p">}</span>
<span class="g g-Whitespace">    </span><span class="mi">588</span> <span class="n">send_kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">settings</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">589</span> <span class="n">resp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">prep</span><span class="p">,</span> <span class="o">**</span><span class="n">send_kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">591</span> <span class="k">return</span> <span class="n">resp</span>

<span class="nn">File ~/work/dara/dara/.venv/lib/python3.12/site-packages/requests/sessions.py:703,</span> in <span class="ni">Session.send</span><span class="nt">(self, request, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">700</span> <span class="n">start</span> <span class="o">=</span> <span class="n">preferred_clock</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">702</span> <span class="c1"># Send the request</span>
<span class="ne">--&gt; </span><span class="mi">703</span> <span class="n">r</span> <span class="o">=</span> <span class="n">adapter</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">705</span> <span class="c1"># Total elapsed time of the request (approximately)</span>
<span class="g g-Whitespace">    </span><span class="mi">706</span> <span class="n">elapsed</span> <span class="o">=</span> <span class="n">preferred_clock</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span>

<span class="nn">File ~/work/dara/dara/.venv/lib/python3.12/site-packages/requests/adapters.py:690,</span> in <span class="ni">HTTPAdapter.send</span><span class="nt">(self, request, stream, timeout, verify, cert, proxies)</span>
<span class="g g-Whitespace">    </span><span class="mi">688</span>     <span class="k">raise</span> <span class="n">SSLError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">689</span> <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">ReadTimeoutError</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">690</span>     <span class="k">raise</span> <span class="n">ReadTimeout</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">691</span> <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">_InvalidHeader</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">692</span>     <span class="k">raise</span> <span class="n">InvalidHeader</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>

<span class="ne">ReadTimeout</span>: HTTPSConnectionPool(host=&#39;www.crystallography.net&#39;, port=443): Read timed out. (read timeout=30)
</pre></div>
</div>
</div>
</div>
<p>Since we are using a pre-filterd database (i.e., the COD), the downloaded CIF files will automatically be named according to the
following convention:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="n">composition</span><span class="p">}</span><span class="n">_</span><span class="p">{</span><span class="n">spacegroup</span><span class="p">}</span><span class="n">_</span><span class="p">(</span><span class="n">cod</span><span class="o">|</span><span class="n">icsd_</span><span class="p">{</span><span class="nb">id</span><span class="p">})</span><span class="o">-</span><span class="p">{</span><span class="n">e_hull</span><span class="p">}</span><span class="o">.</span><span class="n">cif</span>
</pre></div>
</div>
<p>Where the <code class="docutils literal notranslate"><span class="pre">e_hull</span></code> is the energy above the convex hull in meV/atom, as determined from
the Materials Project database for the ground-state entry with matching composition and spacegroup.</p>
</section>
<section id="step-2-search-for-phases">
<h2>Step 2: Search for phases<a class="headerlink" href="#step-2-search-for-phases" title="Link to this heading">#</a></h2>
<p>After preparing the reference CIFs, we can start the phase search on a provided XRD
pattern.</p>
<p>In this case, we are using the XRD pattern from the solid-state reaction sample
on our laboratorys Aeris diffractometer (<code class="docutils literal notranslate"><span class="pre">tutorial_data/GeO2-ZnO_700C_60min.xrdml</span></code>).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># gather all the phases in the &quot;cifs&quot; directory</span>
<span class="n">all_cifs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="s2">&quot;cifs&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">&quot;*.cif&quot;</span><span class="p">))</span>

<span class="n">search_results</span> <span class="o">=</span> <span class="n">search_phases</span><span class="p">(</span>
    <span class="n">pattern_path</span><span class="o">=</span><span class="n">pattern_path</span><span class="p">,</span>
    <span class="n">phases</span><span class="o">=</span><span class="n">all_cifs</span><span class="p">,</span>
    <span class="n">wavelength</span><span class="o">=</span><span class="s2">&quot;Cu&quot;</span><span class="p">,</span>
    <span class="n">instrument_profile</span><span class="o">=</span><span class="s2">&quot;Aeris-fds-Pixcel1d-Medipix3&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-06-26 14:30:14,946 INFO dara.search.tree Detecting peaks in the pattern.
2024-06-26 14:30:24,693 INFO dara.search.tree The wmax is automatically adjusted to 57.88.
2024-06-26 14:30:24,694 INFO dara.search.tree The intensity threshold is automatically set to 10.00 % of maximum peak intensity.
2024-06-26 14:30:24,695 INFO dara.search.tree Creating the root node.
2024-06-26 14:30:24,695 INFO dara.search.tree Refining all the phases in the dataset.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-06-26 14:30:26,609	INFO worker.py:1724 -- Started a local Ray instance.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-06-26 14:30:46,723 INFO dara.search.tree Finished refining 36 phases, with 14 phases removed.
<span class=" -Color -Color-Cyan">(_remote_expand_node pid=58061)</span> 2024-06-26 14:30:46,756 INFO dara.search.tree Expanding node 4ca12eb6-3403-11ef-bdbc-8adca62d6f4b with current phases [], Rwp = None
<span class=" -Color -Color-Cyan">(_remote_expand_node pid=58061)</span> 2024-06-26 14:30:47,937 INFO dara.search.tree Expanding node 5a5bde0c-3403-11ef-ab24-8adca62d6f4b with current phases [RefinementPhase(path=PosixPath(&#39;cifs/GeO2_152_(cod_2300365)-0.cif&#39;), params={})], Rwp = 42.15
<span class=" -Color -Color-Cyan">(_remote_expand_node pid=58052)</span> 2024-06-26 14:30:49,892 INFO dara.search.tree Expanding node 5b83ef90-3403-11ef-9b6b-8adca62d6f4b with current phases [RefinementPhase(path=PosixPath(&#39;cifs/ZnO_186_(cod_9004178)-0.cif&#39;), params={}), RefinementPhase(path=PosixPath(&#39;cifs/Zn2GeO4_148_(cod_9014631)-0.cif&#39;), params={})], Rwp = 44.26
<span class=" -Color -Color-Cyan">(_remote_expand_node pid=58054)</span> 2024-06-26 14:30:51,613 INFO dara.search.tree Expanding node 5c7ff312-3403-11ef-b006-8adca62d6f4b with current phases [RefinementPhase(path=PosixPath(&#39;cifs/GeO2_152_(cod_2300365)-0.cif&#39;), params={}), RefinementPhase(path=PosixPath(&#39;cifs/ZnO_186_(cod_9004178)-0.cif&#39;), params={}), RefinementPhase(path=PosixPath(&#39;cifs/Zn2GeO4_148_(cod_9014631)-0.cif&#39;), params={})], Rwp = 12.04
</pre></div>
</div>
</div>
</div>
</section>
<section id="step-3-result-analysis">
<h2>Step 3: Result analysis<a class="headerlink" href="#step-3-result-analysis" title="Link to this heading">#</a></h2>
<p>The returned search result will be a list of <code class="docutils literal notranslate"><span class="pre">SearchResult</span></code> object.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">search_results</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[SearchResult(refinement_result=RefinementResult(lst_data=LstResult(raw_lst=&#39;Rietveld refinement to file(s) GeO2-ZnO_700C_60min.xy\nBGMN version 4.2.23, 4416 measured points, 121 peaks, 24 parameters\nStart: Wed Jun 26 14:30:50 2024; End: Wed Jun 26 14:30:51 2024\n20 iteration steps\n\nRp=9.96%  Rpb=19.06%  R=10.99%  Rwp=12.04% Rexp=2.69%\nDurbin-Watson d=0.10\n1-rho=1.99%\n\nGlobal parameters and GOALs\n****************************\nQGeO2152cod23003650=0.4771+-0.0021\nQZnO186cod90041780=0.3870+-0.0024\nQZn2GeO4148cod90146310=0.1359+-0.0013\nEPS2=-0.002856+-0.000013\n\nLocal parameters and GOALs for phase GeO2152cod23003650\n******************************************************\nSpacegroupNo=152\nHermannMauguin=P3_121\nXrayDensity=4.276\nRphase=10.88%\nUNIT=NM\nA=0.499111+-0.000024\nC=0.564768+-0.000033\nk1=0.0100000\nB1=0.00500000\nGEWICHT=0.2793+-0.0012\nGrainSize(1,1,1)=84.1811\nAtomic positions for phase GeO2152cod23003650\n---------------------------------------------\n  3     0.4512  0.0000  0.3333     E=(GE(1.0000))\n  6     0.3974  0.3022  0.2429     E=(O(1.0000))\n\nLocal parameters and GOALs for phase ZnO186cod90041780\n******************************************************\nSpacegroupNo=186\nHermannMauguin=P6_3mc\nXrayDensity=5.669\nRphase=9.52%\nUNIT=NM\nA=0.325072+-0.000011\nC=0.520812+-0.000030\nk1=0\nB1=0.003509+-0.000094\nGEWICHT=0.2266+-0.0021\nGrainSize(1,1,1)=120.9+-3.2\nAtomic positions for phase ZnO186cod90041780\n---------------------------------------------\n  2     0.3333  0.6667  0.0000     E=(ZN(1.0000))\n  2     0.3333  0.6667  0.3821     E=(O(1.0000))\n\nLocal parameters and GOALs for phase Zn2GeO4148cod90146310\n******************************************************\nSpacegroupNo=148\nHermannMauguin=R-3\nXrayDensity=4.777\nRphase=20.28%\nUNIT=NM\nA=1.423755+-0.000083\nC=0.952849+-0.000079\nk1=0.0100000\nB1=0.00500000\nGEWICHT=0.07959+-0.00075\nGrainSize(1,1,1)=84.1811\nAtomic positions for phase Zn2GeO4148cod90146310\n---------------------------------------------\n 18     0.2150  0.1940  0.5830     E=(ZN(1.0000))\n 18     0.5483  0.8607  0.5837     E=(ZN(1.0000))\n 18     0.2150  0.1940  0.2500     E=(GE(1.0000))\n 18     0.8877  0.4633  0.4293     E=(O(1.0000))\n 18     0.2220  0.1310  0.4030     E=(O(1.0000))\n 18     0.2230  0.1140  0.7500     E=(O(1.0000))\n 18     0.9957  0.6613  0.5833     E=(O(1.0000))\n&#39;, pattern_name=&#39;GeO2-ZnO_700C_60min.xy&#39;, num_steps=20, rp=9.96, rpb=19.06, r=10.99, rwp=12.04, rexp=2.69, d=0.1, rho=1.99, phases_results={&#39;GeO2_152_(cod_2300365)-0&#39;: PhaseResult(spacegroup_no=152, hermann_mauguin=&#39;P3_121&#39;, xray_density=4.276, rphase=10.88, unit=&#39;NM&#39;, gewicht=(0.2793, 0.0012), gewicht_name=None, a=(0.499111, 2.4e-05), b=None, c=(0.564768, 3.3e-05), alpha=None, beta=None, gamma=None, k1=0.01, B1=0.005), &#39;ZnO_186_(cod_9004178)-0&#39;: PhaseResult(spacegroup_no=186, hermann_mauguin=&#39;P6_3mc&#39;, xray_density=5.669, rphase=9.52, unit=&#39;NM&#39;, gewicht=(0.2266, 0.0021), gewicht_name=None, a=(0.325072, 1.1e-05), b=None, c=(0.520812, 3e-05), alpha=None, beta=None, gamma=None, k1=0, B1=(0.003509, 9.4e-05)), &#39;Zn2GeO4_148_(cod_9014631)-0&#39;: PhaseResult(spacegroup_no=148, hermann_mauguin=&#39;R-3&#39;, xray_density=4.777, rphase=20.28, unit=&#39;NM&#39;, gewicht=(0.07959, 0.00075), gewicht_name=None, a=(1.423755, 8.3e-05), b=None, c=(0.952849, 7.9e-05), alpha=None, beta=None, gamma=None, k1=0.01, B1=0.005)})), phases=((RefinementPhase(path=PosixPath(&#39;cifs/GeO2_152_(cod_2300365)-0.cif&#39;), params={}), RefinementPhase(path=PosixPath(&#39;cifs/GeO2_154_(cod_9007477)-0.cif&#39;), params={})), (RefinementPhase(path=PosixPath(&#39;cifs/ZnO_186_(cod_9004178)-0.cif&#39;), params={}),), (RefinementPhase(path=PosixPath(&#39;cifs/Zn2GeO4_148_(cod_9014631)-0.cif&#39;), params={}),)), foms=((0.0,), (0.03536489998694256, 0.035273051226012), (0.13639804324187943,), (0.33427282595205166,)), lattice_strains=((0.0,), (0.000172525492243293, 0.0005005169609892967), (0.0005712782487738224,), (-0.0033382277696805732,)), missing_peaks=[], extra_peaks=[])]
</pre></div>
</div>
</div>
</div>
<p>In this pattern, we only have one solution found with <code class="docutils literal notranslate"><span class="pre">Rwp</span> <span class="pre">=</span> <span class="pre">12.04</span> <span class="pre">%</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">search_results</span><span class="p">)):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Rwp of solution </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="n">search_results</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">refinement_result</span><span class="o">.</span><span class="n">lst_data</span><span class="o">.</span><span class="n">rwp</span><span class="si">}</span><span class="s2"> %&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Rwp of solution 0 = 12.04 %
</pre></div>
</div>
</div>
</div>
<p>Each <code class="docutils literal notranslate"><span class="pre">SearchResult</span></code> has a <code class="docutils literal notranslate"><span class="pre">.visualize()</span></code> method to visualize the refined pattern and
missing/extra peaks in the solution. If there are no missing or extra peaks, this option
will not appear.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">search_results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">visualize</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>You can also view all the alternative phases in one solution from <code class="docutils literal notranslate"><span class="pre">SearchResult.phases</span></code> attribute.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Phases found in solution 0:&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">phases_</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">search_results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">phases</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    - Phase </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="p">[</span><span class="n">phase</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">name</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">phase</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">phases_</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Phases found in solution 0:
    - Phase 0: [&#39;GeO2_152_(cod_2300365)-0.cif&#39;, &#39;GeO2_154_(cod_9007477)-0.cif&#39;]
    - Phase 1: [&#39;ZnO_186_(cod_9004178)-0.cif&#39;]
    - Phase 2: [&#39;Zn2GeO4_148_(cod_9014631)-0.cif&#39;]
</pre></div>
</div>
</div>
</div>
<p>From the result, you can see that for the phase <code class="docutils literal notranslate"><span class="pre">GeO2</span></code>, the algorithm identifies two
similar phases with slightly different spacegroups (152 and 154).</p>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="automated_refinement.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Tutorial 1: Automated Refinement (with BGMN)</p>
      </div>
    </a>
    <a class="right-next"
       href="../modules.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">dara</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-1-prepare-reference-phases">Step 1: Prepare reference phases</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-2-search-for-phases">Step 2: Search for phases</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-3-result-analysis">Step 3: Result analysis</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Yuxing Fei, Matthew J. McDermott
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
       Copyright 2025, Ceder Group.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>